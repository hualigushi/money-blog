# 白屏时间
白屏时间 = 地址栏输入网址后回车 - 浏览器出现第一个元素

`performance.timing.responseStart - performance.timing.navigationStart`



 # 首屏时间

首屏时间 = 地址栏输入网址后回车 - 浏览器第一屏渲染完成

这段时间其实就是HTML 文档加载和解析的时间。也就是DOMContentLoaded 事件触发之前所经历的时间

- 如果页面首屏有图片

```
首屏时间 = 首屏图片全部加载完毕的时刻 - performance.timing.navigationStart
```

- 如果页面首屏没有图片

```
首屏时间 = performance.timing.domContentLoadedEventStart - performance.timing.navigationStart
```



# 如何优化首屏加载时间

### cdn分发
通过在多台服务器部署相同内容，当用户访问时，服务器根据用户跟哪台服务器地理距离小或者哪台服务器此时的压力小来决定哪台服务器响应这个请求。

### 后端要做好缓存
比如搭建缓存服务器、数据库查询缓存、接口缓存。

### http缓存方案
现在流行的方式是文件hash+强缓存的一个方案。

### 前端的资源动态加载
前端可以做路由动态加载、组件动态加载(offScreen Component)、图片懒加载(offScreen Image)。

### 利用好async和defer这两个属性
如果是独立功能的js文件，可以加入async属性。如果是优先级低且没有依赖的js，我们可以加入defer属性。

### 渲染的优先级
前端可以对接口排优先级，或者对页面的模块排优先级，先请求和渲染优先级高的部分。

### 前端做一些接口缓存
前端也可以做接口缓存，缓存的位置有两个，一个是内存，即保存给变量，另一个是localStorage。比如用户的签到日历（展示用户是否签到），我们可以缓存这样的接口到localStorage，有效期是当天。或者有个列表页，我们总是缓存上次的列表内容到本地，下次加载时，我们先从本地读取缓存，并同时发起请求到服务器获取最新列表。

### 页面使用骨架屏
意思是在首屏加载完成之前，通过渲染一些简单元素进行占位。骨架屏虽然不能提高首屏加载速度，但可以减少用户在首屏等待的急躁情绪。这点很有效，在很多成熟的网站都有大量应用。

### 使用ssr渲染
服务器性能一般都很好，那么可以先在服务器先把vdom计算完成后，再输出给前端，这样可以节约的时间为：计算量/(服务器计算速度 - 客户端计算速度)。第二个是服务器可以把首屏的ajax请求在服务端阶段就完成，这样可以省去和客户端通过tcp传输的时间。

### 引入http2.0
使用http2.0来代替http1.1。当请求较多时，2.0相比1.0的优势会比较明显。

### 选择先进的图片格式
使用 JPEG 2000, JPEG XR, and WebP 的图片格式来代替现有的jpeg和png，当页面图片较多时，这点作用非常明显。

把部分大容量的图片从BaseLine JPEG切换成Progressive JPEG（理解这两者的差别）也能缩小体积。

### 利用好http压缩
使用http压缩的效果非常明显。
