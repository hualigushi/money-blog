## 项目结构
![](https://upload-images.jianshu.io/upload_images/3407939-a849fa742ba8c928?imageMogr2/auto-orient/strip|imageView2/2/w/1032/format/webp)

这是一个组织成 monorepo 形式的工程（简单来说也就是把多个相关子项目放在同一个Git仓库中），使用的lerna这个工具进行管理。

下面是源码中packages下面的各个子项目模块：

- `vue` Vue项目的主入口模块

- `reactivity` 非常重要的模块，实现Vue3.0的数据响应式功能的核心

- `compiler-core` 模板核心语法编译器，包括对标签、属性、指令（如v-if、v-for、v-bind、v-model、v-on、v-once、v-slot等）模板语法的解析

- `compiler-dom` Vue模板编译器，可编译模板中其他功能性指令（如v-clock、v-html、v-text等）。依赖compiler-core

- `runtime-core` 实现虚拟DOM、组件定义、生命周期、指令定义、依赖注入、渲染等功能的核心模块

- `runtime-dom` Vue浏览器DOM环境运行时，负责实现与浏览器环境运行所需的相关特性。依赖runtime-core

- `server-renderer` 服务端渲染（SSR）

## 编译框架源代码
1. npm install
2. npm run dev / npm run build

## 示例
建一个文件夹，下面的文件结构如下图所示，有css和js目录，分别存放示例代码要用到的样式、vue的js库文件、以及编写的示例js代码文件；

而 index.html 则就是这个程序的主入口了。
![](https://upload-images.jianshu.io/upload_images/3407939-249cf02b63d3ca09?imageMogr2/auto-orient/strip|imageView2/2/w/688/format/webp)

index.html,在里面引入css和js文件并创建了一个Vue应用所需的挂载点元素
```
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Vue3.0 Demo</title>

    <link rel="stylesheet" type="text/css" href="./css/main.css" />
</head>

<body>
    <!-- 应用挂载点元素 -->
    <div id="app"></div>

    <!-- 引入Vue3.0库文件 -->
    <script src="./js/lib/vue.global.prod.js"></script>

    <!-- 我们的应用代码 -->
    <script src="./js/main.js"></script>
</body>

</html>
```

main.js
```
const { createApp, createComponent } = Vue

// 计数器组件
const Counter = createComponent({
    template: `
        <div class="counter-display">
            <span class="counter-label">恭喜你，你已经写了</span>
            <span class="counter-text">{{ count }}</span>
            <span class="counter-label">斤代码！</span>
        </div>
        <div class="counter-btns">
            <button class="btn" @click="increase">写一斤</button>
            <button class="btn" @click="reset">删库啦</button>
        </div>
    `,

    data() {
        return {
            count: 0
        }
    },

    methods: {
        increase() {
            this.count++;
        },
        reset() {
            this.count = 0;
        }
    }
})

// 根组件
const App = createComponent({
    components: { Counter },
    template: `
        <div class="container">
            <h3>计数器示例</h3>
            <Counter />
        </div>
    `
})

// 启动
const container = document.querySelector('#app')
const app = createApp()

app.mount(App, container)
```
createComponent()函数不是必须的，完全可以去掉，它的存在是为了使用TypeScript编写代码时，利用TypeScript的类型推断机制在开发工具里（如VSCode）实现更好的参数自动提示功能。

写成下面这样也是完全可以工作的：
```
const App = {
    components: { Counter },
    template: `
        <div class="container">
            <h3>计数器示例</h3>
            <Counter />
        </div>
    `
}
```
main.css
```
.container {
    border: 1px solid #cccccc;
    border-radius: 5px;
    width: 250px;
    padding: 20px;
}

.counter-display {
    margin-bottom: 20px;
}

.counter-text {
    font-size: 18px;
    font-weight: bold;
    color: #ff9900;
    margin: 0 5px;
}

.counter-btns .btn {
    border: 1px solid #cccccc;
    border-radius: 5px;
    width: 80px;
    height: 40px;
    outline: none;
    background: #f2f2f2;
    margin-right: 10px;
}
```
